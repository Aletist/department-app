{% extends 'base.html' %}

{% block title %} Department {% endblock %}
{% block top %}
    {% call macros.block_top('Department', 'departments') %}
        <label for="modal_edit" class="button">Edit <i class="el el-pencil"></i></label>
    {% endcall %}
    <div class="modal">
        <input id="modal_edit" type="checkbox"/>
        <label for="modal_edit" class="overlay"></label>
        <form action="{{ url_for('edit_dept', name = dept['name']) }}" method="post">
            <section>
                <header>
                    <h3>Edit department</h3>
                    <label for="modal_edit" class="close">&times;</label>
                </header>
                <section style="width: 25em">
                    <p>Department name:</p>
                    <label>
                        <input type="text" name="name" value="{{ dept['name'] }}"
                               placeholder="Current: {{ dept['name'] }}">
                    </label>
                    <p>Department head:</p>
                    <select name="new_head">
                        <option value="{{ dept['head'] }}">{{ dept['head'] }}</option>
                        {% for employee in employees %}
                            {% if employee['id'] != dept['head_id'] %}
                                <option value="{{ employee['id'] }}">
                                    {{ employee['id'] }}, {{ employee['first_name'] }} {{ employee['last_name'] }}
                                </option>
                            {% endif %}
                        {% endfor %}
                    </select>
                    <p>Department head's salary:</p>
                    <label>
                        <input name="head_salary" type="number" min="0" value="{{ dept['head_salary'] }}">
                    </label>
                </section>
                <footer>
                    <button class="success">Accept</button>
                    <label for="modal_edit" class="button dangerous">
                        Cancel
                    </label>
                </footer>
            </section>
        </form>
    </div>
{% endblock %}

{% block middle %}
    <div style="background-color: #eeeeee">
        <h4>Department name: {{ dept['name'] }}</h4>
        <h4>Department head: {{ dept['head'] }}</h4>
    </div>
{% endblock %}

{% block bottom %}
    <table>
        <thead>
        <tr>
            <th>ID</th>
            <th>First Name</th>
            <th>Last Name</th>
            <th>Salary</th>
            <th>Birth date</th>
            <th>Hire date</th>
            <th></th>
        </tr>
        </thead>
        <tbody>
        {% for employee in employees %}
            {% call macros.employee_row(employee) %}
                {% call macros.control_cell(employee['id'], 'id', 'employee') %}{% endcall %}
            {% endcall %}
            {% call macros.modal_delete(employee['id'], 'id','remove_employee') %}
                Are you sure you want to remove employee {{ employee['id'] }}, {{ employee['first_name'] }}
                {{ employee['last_name'] }} from department?
            {% endcall %}
        {% endfor %}
        </tbody>
    </table>
{% endblock %}

